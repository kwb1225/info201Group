ditch_the_axes
ggplot() +
geom_polygon(data = states_test, aes(x = long, y = lat, group = group), color = "black", fill = "grey", size = 0.5)
ggplot() +
geom_polygon(data = states_test, aes(x = long, y = lat, group = group), color = "black", fill = "grey", size = 0.5) +
coord_map() +
theme_nothing()
ggplot() +
geom_polygon(data = states_test, aes(x = long, y = lat, group = group), color = "black", fill = "grey", size = 0.5) +
coord_map() +
geom_polygon(data = counties_test_new, aes(x = long, y = lat, fill = name), color = "white") +
theme_nothing(legend = TRUE)
ggplot() +
geom_polygon(data = states_test, aes(x = long, y = lat, group = group), color = "black", fill = "grey", size = 0.5) +
coord_map() +
geom_polygon(data = counties_test_new, aes(fill = name), color = "white") +
theme_nothing(legend = TRUE)
ggplot() +
geom_polygon(data = states_test, aes(x = long, y = lat, group = group), color = "black", fill = "grey", size = 0.5) +
coord_map() +
geom_polygon(data = counties_test_new, aes(x = long, y = lat, group = group, fill = name), color = "white") +
theme_nothing(legend = TRUE)
ggplot() +
#geom_polygon(data = states_test, aes(x = long, y = lat, group = group), color = "black", fill = "grey", size = 0.5) +
#coord_map() +
geom_polygon(data = counties_test_new, aes(x = long, y = lat, group = group, fill = name), color = "white") +
theme_nothing(legend = TRUE) +
coord_map()
ggplot() +
#geom_polygon(data = states_test, aes(x = long, y = lat, group = group), color = "black", fill = "grey", size = 0.5) +
#coord_map() +
geom_polygon(data = counties_test_new, aes(x = long, y = lat, group = group, fill = name), color = "white") +
theme_nothing(legend = TRUE) +
coord_map() +
geom_polygon(data = states_test, mapping = aes(x = long, y = lat, group = group), color = "black", fill = NA)
ggplot() +
#geom_polygon(data = states_test, aes(x = long, y = lat, group = group), color = "black", fill = "grey", size = 0.5) +
#coord_map() +
geom_polygon(data = counties_test_new, aes(x = long, y = lat, group = group, fill = name), color = "white") +
scale_fill_manual(values = c("green", "blue"))
theme_nothing(legend = TRUE) +
coord_map() +
ggplot() +
#geom_polygon(data = states_test, aes(x = long, y = lat, group = group), color = "black", fill = "grey", size = 0.5) +
#coord_map() +
geom_polygon(data = counties_test_new, aes(x = long, y = lat, group = group, fill = name), color = "white") +
scale_fill_manual(values = c("green", "blue"))
theme_nothing(legend = TRUE) +
coord_map()
ggplot() +
#geom_polygon(data = states_test, aes(x = long, y = lat, group = group), color = "black", fill = "grey", size = 0.5) +
#coord_map() +
geom_polygon(data = counties_test_new, aes(x = long, y = lat, group = group, fill = name), color = "white") +
scale_fill_manual(values = c("green", "blue"))
theme_nothing(legend = TRUE) +
coord_map() +
geom_polygon(data = states_test, mapping = aes(x = long, y = lat, group = group), color = "black", fill = NA)
ggplot() +
#geom_polygon(data = states_test, aes(x = long, y = lat, group = group), color = "black", fill = "grey", size = 0.5) +
coord_map() +
geom_polygon(data = counties_test_new, aes(x = long, y = lat, group = group, fill = name), color = "white") +
scale_fill_manual(values = c("green", "blue"))
theme_nothing(legend = TRUE) +
geom_polygon(data = states_test, mapping = aes(x = long, y = lat, group = group), color = "black", fill = NA)
ggplot() +
#geom_polygon(data = states_test, aes(x = long, y = lat, group = group), color = "black", fill = "grey", size = 0.5) +
coord_map() +
geom_polygon(data = counties_test_new, aes(x = long, y = lat, group = group, fill = name), color = "white") +
scale_fill_manual(values = c("green", "blue")) +
theme_nothing(legend = TRUE) +
geom_polygon(data = states_test, mapping = aes(x = long, y = lat, group = group), color = "black", fill = NA)
ggplot() +
#geom_polygon(data = states_test, aes(x = long, y = lat, group = group), color = "black", fill = "grey", size = 0.5) +
coord_map() +
geom_polygon(data = counties_test_new, aes(x = long, y = lat, group = group, fill = name), color = "white") +
scale_fill_manual(values = c("red", "lightblue")) +
theme_nothing(legend = TRUE) +
geom_polygon(data = states_test, mapping = aes(x = long, y = lat, group = group), color = "black", fill = NA)
ggplot() +
#geom_polygon(data = states_test, aes(x = long, y = lat, group = group), color = "black", fill = "grey", size = 0.5) +
coord_map() +
geom_polygon(data = counties_test_new, aes(x = long, y = lat, group = group, fill = name), color = "white") +
scale_fill_manual(values = c("lightred", "lightblue")) +
theme_nothing(legend = TRUE) +
geom_polygon(data = states_test, mapping = aes(x = long, y = lat, group = group), color = "black", fill = NA)
ggplot() +
#geom_polygon(data = states_test, aes(x = long, y = lat, group = group), color = "black", fill = "grey", size = 0.5) +
coord_map() +
geom_polygon(data = counties_test_new, aes(x = long, y = lat, group = group, fill = name), color = "white") +
scale_fill_manual(values = c("red2", "royalblue2")) +
theme_nothing(legend = TRUE) +
geom_polygon(data = states_test, mapping = aes(x = long, y = lat, group = group), color = "black", fill = NA)
ggplot() +
#geom_polygon(data = states_test, aes(x = long, y = lat, group = group), color = "black", fill = "grey", size = 0.5) +
coord_map() +
geom_polygon(data = counties_test_new, aes(x = long, y = lat, group = group, fill = name), color = "white") +
scale_fill_manual(values = c("firebrick2", "steelblue2")) +
theme_nothing(legend = TRUE) +
geom_polygon(data = states_test, mapping = aes(x = long, y = lat, group = group), color = "black", fill = NA)
ggplot() +
#geom_polygon(data = states_test, aes(x = long, y = lat, group = group), color = "black", fill = "grey", size = 0.5) +
coord_map() +
geom_polygon(data = counties_test_new, aes(x = long, y = lat, group = group, fill = name), color = "white") +
scale_fill_manual(values = c("firebrick1", "steelblue1")) +
theme_nothing(legend = TRUE) +
geom_polygon(data = states_test, mapping = aes(x = long, y = lat, group = group), color = "black", fill = NA)
ggplot() +
#geom_polygon(data = states_test, aes(x = long, y = lat, group = group), color = "black", fill = "grey", size = 0.5) +
coord_map() +
geom_polygon(data = counties_test_new, aes(x = long, y = lat, group = group, fill = name), color = "white") +
scale_fill_manual(values = c("tomato1", "steelblue1")) +
theme_nothing(legend = TRUE) +
geom_polygon(data = states_test, mapping = aes(x = long, y = lat, group = group), color = "black", fill = NA)
ggplot() +
#geom_polygon(data = states_test, aes(x = long, y = lat, group = group), color = "black", fill = "grey", size = 0.5) +
coord_map() +
geom_polygon(data = counties_test_new, aes(x = long, y = lat, group = group, fill = name), color = "white") +
scale_fill_manual(values = c("tomato1", "steelblue1")) +
theme_nothing(legend = TRUE) +
geom_polygon(data = states_test, mapping = aes(x = long, y = lat, group = group), color = "black", fill = NA, size = 0.5)
ggplot() +
#geom_polygon(data = states_test, aes(x = long, y = lat, group = group), color = "black", fill = "grey", size = 0.5) +
coord_map() +
geom_polygon(data = counties_test_new, aes(x = long, y = lat, group = group, fill = name), color = "white") +
scale_fill_manual(name = "President", values = c("tomato1", "steelblue1")) +
theme_nothing(legend = TRUE) +
geom_polygon(data = states_test, mapping = aes(x = long, y = lat, group = group), color = "black", fill = NA, size = 0.5)
ggplot() +
#geom_polygon(data = states_test, aes(x = long, y = lat, group = group), color = "black", fill = "grey", size = 0.5) +
coord_map() +
geom_polygon(data = counties_test_new, aes(x = long, y = lat, group = group, fill = name), color = "white") +
scale_fill_manual(name = "Candidate", values = c("tomato1", "steelblue1")) +
theme_nothing(legend = TRUE) +
geom_polygon(data = states_test, mapping = aes(x = long, y = lat, group = group), color = "black", fill = NA, size = 0.5) +
geom_text(data = states_test, aes(long, lat, label = region), size = 2, fontface = "bold")
states_name_location <- aggregate(cbind(long, lat) ~ region, data = states_test, FUN = function(x) mean(range(x)))
ggplot() +
#geom_polygon(data = states_test, aes(x = long, y = lat, group = group), color = "black", fill = "grey", size = 0.5) +
coord_map() +
geom_polygon(data = counties_test_new, aes(x = long, y = lat, group = group, fill = name), color = "white") +
scale_fill_manual(name = "Candidate", values = c("tomato1", "steelblue1")) +
theme_nothing(legend = TRUE) +
geom_polygon(data = states_test, mapping = aes(x = long, y = lat, group = group), color = "black", fill = NA, size = 0.5) +
geom_text(data = states_name_location, aes(long, lat, label = region), size = 2, fontface = "bold")
ggplot() +
#geom_polygon(data = states_test, aes(x = long, y = lat, group = group), color = "black", fill = "grey", size = 0.5) +
coord_map() +
geom_polygon(data = counties_test_new, aes(x = long, y = lat, group = group, fill = name), color = "white") +
scale_fill_manual(name = "Candidate", values = c("tomato1", "steelblue1")) +
theme_nothing(legend = TRUE) +
geom_polygon(data = states_test, mapping = aes(x = long, y = lat, group = group), color = "black", fill = NA, size = 0.5) +
geom_text(data = states_name_location, aes(long, lat, label = region), size = 5, fontface = "bold")
View(states_name_location)
ggplot(data = states_test, mapping = aes(x = long, y = lat, group = group)) +
coord_fixed(1.3) +
geom_polygon(color = "black", fill = "grey") +
theme_nothing() +
geom_polygon(data = counties_test_new, aes(fill = name), color = NA) +
geom_polygon(color = "black", fill = NA) +
theme_bw() +
ditch_the_axes
ggplot() +
#geom_polygon(data = states_test, aes(x = long, y = lat, group = group), color = "black", fill = "grey", size = 0.5) +
coord_map() +
geom_polygon(data = counties_test_new, aes(x = long, y = lat, group = group, fill = name), color = NA) +
scale_fill_manual(name = "Candidate", values = c("tomato1", "steelblue1")) +
theme_nothing(legend = TRUE) +
geom_polygon(data = states_test, mapping = aes(x = long, y = lat, group = group), color = "white", fill = NA, size = 0.5) +
geom_text(data = states_name_location, aes(long, lat, label = region), size = 4, fontface = "bold")
install.packages("ggrepel")
library(ggrepel)
ggplot() +
#geom_polygon(data = states_test, aes(x = long, y = lat, group = group), color = "black", fill = "grey", size = 0.5) +
coord_map() +
geom_polygon(data = counties_test_new, aes(x = long, y = lat, group = group, fill = name), color = NA) +
scale_fill_manual(name = "Candidate", values = c("tomato1", "steelblue1")) +
theme_nothing(legend = TRUE) +
geom_polygon(data = states_test, mapping = aes(x = long, y = lat, group = group), color = "white", fill = NA, size = 0.5) +
geom_text_repel(data = states_name_location, aes(long, lat, label = region), size = 4, fontface = "bold")
View(mtcars)
ggplot() +
#geom_polygon(data = states_test, aes(x = long, y = lat, group = group), color = "black", fill = "grey", size = 0.5) +
coord_map() +
geom_polygon(data = counties_test_new, aes(x = long, y = lat, group = group, fill = name), color = NA) +
scale_fill_manual(name = "Candidate", values = c("tomato1", "steelblue1")) +
theme_nothing(legend = TRUE) +
geom_polygon(data = states_test, mapping = aes(x = long, y = lat, group = group), color = "white", fill = NA, size = 0.5) +
geom_text_repel(mapping = aes(x = long, y = lat), data = states_name_location, aes(label = region), size = 4, fontface = "bold")
library(ggrepel)
geom_text_repel(data = states_name_location, aes(long, lat, label = region), size = 4, fontface = "bold")
View(states_name_location)
ggplot() +
#geom_polygon(data = states_test, aes(x = long, y = lat, group = group), color = "black", fill = "grey", size = 0.5) +
coord_map() +
geom_polygon(data = counties_test_new, aes(x = long, y = lat, group = group, fill = name), color = NA) +
scale_fill_manual(name = "Candidate", values = c("tomato1", "steelblue1")) +
theme_nothing(legend = TRUE) +
geom_polygon(data = states_test, mapping = aes(x = long, y = lat, group = group), color = "white", fill = NA, size = 0.5) +
geom_text_repel(data = states_name_location, aes(long, lat, label = region))
ggplot(mtcars, aes(wt, mpg)) +
geom_point(color = 'red') +
geom_text_repel(aes(label = rownames(mtcars))) +
theme_classic(base_size = 16)
install.packages(c(shiny, dplyr, plotly))
install.packages(c("shiny", "dplyr", "plotly", "maps", "mapproj", "ggplot2", "ggrepel", "ggmap"))
install.packages(c("shiny", "dplyr", "plotly", "maps", "mapproj", "ggplot2", "ggrepel", "ggmap"))
install.packages(c("shiny", "dplyr", "plotly", "maps", "mapproj", "ggplot2", "ggrepel", "ggmap"))
library(shiny)
library(dplyr)
library(plotly)
library(maps)
library(mapproj)
library(ggplot2)
library(ggmap)
library(ggrepel)
library(shiny)
library(dplyr)
library(plotly)
#install.packages("choroplethr")
#install.packages("choroplethrMaps")
library(choroplethr)
library(choroplethrMaps)
library(maps)
library(mapproj)
library(ggplot2)
library(ggmap)
#install.packages("ggrepel")
library(ggrepel)
counties_rds <- readRDS("data/counties.rds")
votes <- read.csv("data/presidential_general_election_2016_by_county.csv", stringsAsFactors = FALSE)
map("county", fill = TRUE, col = c("white", "darkgreen"),
resolution = 0, lty = 0, projection = "polyconic",
myborder = 0, mar = c(0,0,0,0)
counties_test <- map_data("county")
states_test <- map_data("state")
ggplot(data = states_test, mapping = aes(x = long, y = lat, group = group)) +
coord_fixed(1.3) +
geom_polygon(color = "black", fill = "grey") +
theme_nothing() +
geom_polygon(data = counties_test, fill = NA, color = "white") +
geom_polygon(color = "black", fill = NA)
modified_votes <- votes %>%
filter(rank == "1") %>%
select(geo_name, name, rank, vote_pct, votes)
subregion <- tolower(modified_votes$geo_name) %>%
str_replace_all(" county", "")
modified_votes <- modified_votes %>%
mutate(subregion = subregion)
counties_test_new <- inner_join(counties_test, modified_votes, by = "subregion")
ditch_the_axes <- theme(
axis.text = element_blank(),
axis.line = element_blank(),
axis.ticks = element_blank(),
panel.border = element_blank(),
panel.grid = element_blank(),
axis.title = element_blank()
)
ggplot(data = states_test, mapping = aes(x = long, y = lat, group = group)) +
coord_fixed(1.3) +
geom_polygon(color = "black", fill = "grey") +
theme_nothing() +
geom_polygon(data = counties_test_new, aes(fill = name), color = NA) +
geom_polygon(color = "black", fill = NA) +
theme_bw() +
ditch_the_axes
states_name_location <- aggregate(cbind(long, lat) ~ region, data = states_test, FUN = function(x) mean(range(x))) %>%
ggplot() +
#geom_polygon(data = states_test, aes(x = long, y = lat, group = group), color = "black", fill = "grey", size = 0.5) +
coord_map() +
geom_polygon(data = counties_test_new, aes(x = long, y = lat, group = group, fill = name), color = "white") +
scale_fill_manual(name = "Candidate", values = c("tomato1", "steelblue1")) +
theme_nothing(legend = TRUE) +
geom_polygon(data = states_test, mapping = aes(x = long, y = lat, group = group), color = "black", fill = NA, size = 0.5) +
geom_text(data = states_name_location, aes(long, lat, label = region), size = 4, fontface = "bold")
ggplot() +
#geom_polygon(data = states_test, aes(x = long, y = lat, group = group), color = "black", fill = "grey", size = 0.5) +
coord_map() +
geom_polygon(data = counties_test_new, aes(x = long, y = lat, group = group, fill = name), color = NA) +
scale_fill_manual(name = "Candidate", values = c("tomato1", "steelblue1")) +
theme_nothing(legend = TRUE) +
geom_polygon(data = states_test, mapping = aes(x = long, y = lat, group = group), color = "white", fill = NA, size = 0.5)
#geom_text_repel(data = states_name_location, aes(long, lat, label = region))
#hillary_votes <- votes %>%
# filter(name == "H. Clinton") %>%
# select(geo_name, name, rank, vote_pct, votes)
#trump_votes <- votes %>%
# filter(name == "D. Trump") %>%
# select(geo_name, name, rank, vote_pct, votes)
ggplot() +
#geom_polygon(data = states_test, aes(x = long, y = lat, group = group), color = "black", fill = "grey", size = 0.5) +
coord_map() +
geom_polygon(data = counties_test_new, aes(x = long, y = lat, group = group, fill = name), color = NA) +
scale_fill_manual(name = "Candidate", values = c("tomato1", "steelblue1")) +
theme_nothing(legend = TRUE) +
geom_polygon(data = states_test, mapping = aes(x = long, y = lat, group = group), color = "white", fill = NA, size = 0.5)
geom_text_repel(data = states_name_location, aes(long, lat, label = region))
geom_text_repel(data = states_name_location, aes(long, lat, label = region))
library(ggrepel)
geom_text_repel(data = states_name_location, aes(long, lat, label = region))
states_name_location <- aggregate(cbind(long, lat) ~ region, data = states_test, FUN = function(x) mean(range(x))) %>%
states_name_location <- as.data.frame(states_name_location)
ggplot() +
#geom_polygon(data = states_test, aes(x = long, y = lat, group = group), color = "black", fill = "grey", size = 0.5) +
coord_map() +
geom_polygon(data = counties_test_new, aes(x = long, y = lat, group = group, fill = name), color = "white") +
scale_fill_manual(name = "Candidate", values = c("tomato1", "steelblue1")) +
theme_nothing(legend = TRUE) +
geom_polygon(data = states_test, mapping = aes(x = long, y = lat, group = group), color = "black", fill = NA, size = 0.5) +
geom_text(data = states_name_location, aes(long, lat, label = region), size = 4, fontface = "bold")
counties_rds <- readRDS("data/counties.rds")
votes <- read.csv("data/presidential_general_election_2016_by_county.csv", stringsAsFactors = FALSE)
counties_test <- map_data("county")
states_test <- map_data("state")
modified_votes <- votes %>%
filter(rank == "1") %>%
select(geo_name, name, rank, vote_pct, votes)
subregion <- tolower(modified_votes$geo_name) %>%
str_replace_all(" county", "")
modified_votes <- modified_votes %>%
mutate(subregion = subregion)
counties_test_new <- inner_join(counties_test, modified_votes, by = "subregion")
ditch_the_axes <- theme(
axis.text = element_blank(),
axis.line = element_blank(),
axis.ticks = element_blank(),
panel.border = element_blank(),
panel.grid = element_blank(),
axis.title = element_blank()
)
ggplot(data = states_test, mapping = aes(x = long, y = lat, group = group)) +
coord_fixed(1.3) +
geom_polygon(color = "black", fill = "grey") +
theme_nothing() +
geom_polygon(data = counties_test_new, aes(fill = name), color = NA) +
geom_polygon(color = "black", fill = NA) +
theme_bw() +
ditch_the_axes
states_name_location <- aggregate(cbind(long, lat) ~ region, data = states_test, FUN = function(x) mean(range(x))) %>%
states_name_location <- as.data.frame(states_name_location)
states_name_location <- aggregate(cbind(long, lat) ~ region, data = states_test, FUN = function(x) mean(range(x)))
states_name_location <- as.data.frame(states_name_location)
ggplot() +
#geom_polygon(data = states_test, aes(x = long, y = lat, group = group), color = "black", fill = "grey", size = 0.5) +
coord_map() +
geom_polygon(data = counties_test_new, aes(x = long, y = lat, group = group, fill = name), color = NA) +
scale_fill_manual(name = "Candidate", values = c("tomato1", "steelblue1")) +
theme_nothing(legend = TRUE) +
geom_polygon(data = states_test, mapping = aes(x = long, y = lat, group = group), color = "white", fill = NA, size = 0.5)
geom_text_repel(data = states_name_location, aes(long, lat, label = region))
ggplot() +
#geom_polygon(data = states_test, aes(x = long, y = lat, group = group), color = "black", fill = "grey", size = 0.5) +
coord_map() +
geom_polygon(data = counties_test_new, aes(x = long, y = lat, group = group, fill = name), color = "white") +
scale_fill_manual(name = "Candidate", values = c("tomato1", "steelblue1")) +
geom_polygon(data = states_test, mapping = aes(x = long, y = lat, group = group), color = "black", fill = NA, size = 0.5) +
geom_text(data = states_name_location, aes(long, lat, label = region), size = 4, fontface = "bold")
ggplot() +
#geom_polygon(data = states_test, aes(x = long, y = lat, group = group), color = "black", fill = "grey", size = 0.5) +
coord_map() +
geom_polygon(data = counties_test_new, aes(x = long, y = lat, group = group, fill = name), color = NA) +
scale_fill_manual(name = "Candidate", values = c("tomato1", "steelblue1")) +
geom_polygon(data = states_test, mapping = aes(x = long, y = lat, group = group), color = "white", fill = NA, size = 0.5)
geom_text_repel(data = states_name_location, aes(long, lat, label = region))
ggplot() +
#geom_polygon(data = states_test, aes(x = long, y = lat, group = group), color = "black", fill = "grey", size = 0.5) +
coord_map() +
geom_polygon(data = counties_test_new, aes(x = long, y = lat, group = group, fill = name), color = NA) +
scale_fill_manual(name = "Candidate", values = c("tomato1", "steelblue1")) +
geom_polygon(data = states_test, mapping = aes(x = long, y = lat, group = group), color = "white", fill = NA, size = 0.5)
geom_text_repel(data = states_name_location, aes(long, lat, label = region)) +
theme_nothing(legend = TRUE)
ggplot() +
coord_map() +
geom_polygon(data = counties_test_new, aes(x = long, y = lat, group = group, fill = name), color = NA) +
scale_fill_manual(name = "Candidate", values = c("tomato1", "steelblue1")) +
geom_polygon(data = states_test, mapping = aes(x = long, y = lat, group = group), color = "white", fill = NA, size = 0.5)
geom_text_repel(data = states_name_location, aes(long, lat, label = region)) +
theme_nothing(legend = TRUE)
ggplot() +
coord_map() +
geom_polygon(data = counties_test_new, aes(x = long, y = lat, group = group, fill = name), color = NA) +
scale_fill_manual(name = "Candidate", values = c("tomato1", "steelblue1")) +
geom_polygon(data = states_test, mapping = aes(x = long, y = lat, group = group), color = "white", fill = NA, size = 0.5)
geom_text_repel(data = states_name_location, aes(long, lat, label = region)) +
theme_nothing(legend = TRUE)
ggplot() +
coord_map() +
geom_polygon(data = counties_test_new, aes(x = long, y = lat, group = group, fill = name), color = "white") +
scale_fill_manual(name = "Candidate", values = c("tomato1", "steelblue1")) +
geom_polygon(data = states_test, mapping = aes(x = long, y = lat, group = group), color = "black", fill = NA, size = 0.5) +
geom_text(data = states_name_location, aes(long, lat, label = region), size = 4, fontface = "bold") +
theme_nothing(legend = TRUE)
ggplot() +
coord_map() +
geom_polygon(data = counties_test_new, aes(x = long, y = lat, group = group, fill = name), color = NA) +
scale_fill_manual(name = "Candidate", values = c("tomato1", "steelblue1")) +
geom_polygon(data = states_test, mapping = aes(x = long, y = lat, group = group), color = "white", fill = NA, size = 0.5)
#geom_text_repel(data = states_name_location, aes(long, lat, label = region)) +
theme_nothing(legend = TRUE)
counties_rds <- readRDS("data/counties.rds")
votes <- read.csv("data/presidential_general_election_2016_by_county.csv", stringsAsFactors = FALSE)
library(shiny)
library(dplyr)
library(plotly)
#install.packages("choroplethr")
#install.packages("choroplethrMaps")
library(choroplethr)
library(choroplethrMaps)
library(maps)
library(mapproj)
library(ggplot2)
library(ggmap)
#install.packages("ggrepel")
library(ggrepel)
counties_rds <- readRDS("data/counties.rds")
votes <- read.csv("data/presidential_general_election_2016_by_county.csv", stringsAsFactors = FALSE)
#map("county", fill = TRUE, col = c("white", "darkgreen"),
#resolution = 0, lty = 0, projection = "polyconic",
#myborder = 0, mar = c(0,0,0,0)
counties_test <- map_data("county")
states_test <- map_data("state")
#ggplot(data = states_test, mapping = aes(x = long, y = lat, group = group)) +
#coord_fixed(1.3) +
#geom_polygon(color = "black", fill = "grey") +
#theme_nothing() +
#geom_polygon(data = counties_test, fill = NA, color = "white") +
#geom_polygon(color = "black", fill = NA)
modified_votes <- votes %>%
filter(rank == "1") %>%
select(geo_name, name, rank, vote_pct, votes)
subregion <- tolower(modified_votes$geo_name) %>%
str_replace_all(" county", "")
modified_votes <- modified_votes %>%
mutate(subregion = subregion)
counties_test_new <- inner_join(counties_test, modified_votes, by = "subregion")
ditch_the_axes <- theme(
axis.text = element_blank(),
axis.line = element_blank(),
axis.ticks = element_blank(),
panel.border = element_blank(),
panel.grid = element_blank(),
axis.title = element_blank()
)
ggplot(data = states_test, mapping = aes(x = long, y = lat, group = group)) +
coord_fixed(1.3) +
geom_polygon(color = "black", fill = "grey") +
theme_nothing() +
geom_polygon(data = counties_test_new, aes(fill = name), color = NA) +
geom_polygon(color = "black", fill = NA) +
theme_bw() +
ditch_the_axes
states_name_location <- aggregate(cbind(long, lat) ~ region, data = states_test, FUN = function(x) mean(range(x)))
states_name_location <- as.data.frame(states_name_location)
ggplot() +
coord_map() +
geom_polygon(data = counties_test_new, aes(x = long, y = lat, group = group, fill = name), color = "white") +
scale_fill_manual(name = "Candidate", values = c("tomato1", "steelblue1")) +
geom_polygon(data = states_test, mapping = aes(x = long, y = lat, group = group), color = "black", fill = NA, size = 0.5) +
geom_text(data = states_name_location, aes(long, lat, label = region), size = 4, fontface = "bold") +
theme_nothing(legend = TRUE)
ggplot() +
coord_map() +
geom_polygon(data = counties_test_new, aes(x = long, y = lat, group = group, fill = name), color = NA) +
scale_fill_manual(name = "Candidate", values = c("tomato1", "steelblue1")) +
geom_polygon(data = states_test, mapping = aes(x = long, y = lat, group = group), color = "white", fill = NA, size = 0.5)
#geom_text_repel(data = states_name_location, aes(long, lat, label = region)) +
theme_nothing(legend = TRUE)
#gom_polygon(data = states_test, aes(x = long, y = lat, group = group), color = "black", fill = "grey", size = 0.5) +
#hillary_votes <- votes %>%
# filter(name == "H. Clinton") %>%
# select(geo_name, name, rank, vote_pct, votes)
#trump_votes <- votes %>%
# filter(name == "D. Trump") %>%
# select(geo_name, name, rank, vote_pct, votes)
ggplot() +
coord_map() +
geom_polygon(data = counties_test_new, aes(x = long, y = lat, group = group, fill = name), color = "white") +
scale_fill_manual(name = "Candidate", values = c("tomato1", "steelblue1")) +
geom_polygon(data = states_test, mapping = aes(x = long, y = lat, group = group), color = "black", fill = NA, size = 0.5) +
geom_text(data = states_name_location, aes(long, lat, label = region), size = 4, fontface = "bold") +
theme_nothing(legend = TRUE)
ggplot() +
coord_map() +
geom_polygon(data = counties_test_new, aes(x = long, y = lat, group = group, fill = name), color = NA) +
scale_fill_manual(name = "Candidate", values = c("tomato1", "steelblue1")) +
geom_polygon(data = states_test, mapping = aes(x = long, y = lat, group = group), color = "white", fill = NA, size = 0.5) +
#geom_text_repel(data = states_name_location, aes(long, lat, label = region)) +
theme_nothing(legend = TRUE)
library(shiny)
ggplot() +
coord_map() +
geom_polygon(data = counties_test_new, aes(x = long, y = lat, group = group, fill = name), color = "white") +
scale_fill_manual(name = "Candidate", values = c("tomato1", "steelblue1")) +
geom_polygon(data = states_test, mapping = aes(x = long, y = lat, group = group), color = "black", fill = NA, size = 0.5) +
theme_nothing(legend = TRUE)
counties_name_location <- aggregate(cbind(long, lat) ~subregion, data = states_test_new, FUN = function(x) mean(range(x)))
counties_name_location <- as.data.frame(counties_name_location)
counties_name_location <- aggregate(cbind(long, lat) ~subregion, data = states_test_new, FUN = function(x) mean(range(x)))
counties_name_location <- aggregate(cbind(long, lat) ~subregion, data = counties_test_new, FUN = function(x) mean(range(x)))
counties_name_location <- as.data.frame(counties_name_location)
list("all", counties_name_location$subregion)
state_coloring <- counties_test_new %>%
filter(region == input$state)
county_coloring <- state_coloring %>%
filter(subregion == input$county)
counties_test_new[counties_test_new$region="alabama"]
counties_test_new[counties_test_new$region = "alabama"]
counties_test_new$region[counties_test_new$region = "alabama"]
runApp('tab2')
runApp('tab2')
runApp('tab2')
runApp('tab2')
